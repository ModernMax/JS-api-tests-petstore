"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.transformPathsObj = void 0;
const utils_1 = require("../utils");
const operation_1 = require("./operation");
const parameters_1 = require("./parameters");
function transformPathsObj(paths, { globalParameters, immutableTypes, operations, version }) {
    const readonly = utils_1.tsReadonly(immutableTypes);
    let output = "";
    Object.entries(paths).forEach(([url, pathItem]) => {
        if (pathItem.description)
            output += utils_1.comment(pathItem.description);
        if (pathItem.$ref) {
            output += `  ${readonly}"${url}": ${utils_1.transformRef(pathItem.$ref)};\n`;
            return;
        }
        output += ` ${readonly}"${url}": {\n`;
        ["get", "put", "post", "delete", "options", "head", "patch", "trace"].forEach((method) => {
            const operation = pathItem[method];
            if (!operation)
                return;
            if (operation.description)
                output += utils_1.comment(operation.description);
            if (operation.operationId) {
                operations[operation.operationId] = { operation, pathItem };
                output += `    ${readonly}"${method}": operations["${operation.operationId}"];\n`;
                return;
            }
            output += `    ${readonly}"${method}": {\n      ${operation_1.transformOperationObj(operation, {
                globalParameters,
                immutableTypes,
                pathItem,
                version,
            })}\n    }\n`;
        });
        if (pathItem.parameters) {
            output += `   ${readonly}parameters: {\n      ${parameters_1.transformParametersArray(pathItem.parameters, {
                globalParameters,
                immutableTypes,
                version,
            })}\n    }\n`;
        }
        output += `  }\n`;
    });
    return output;
}
exports.transformPathsObj = transformPathsObj;
//# sourceMappingURL=paths.js.map